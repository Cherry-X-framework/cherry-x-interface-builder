!function(t){"use strict";({init:function(){this.component.init(),t(document).on("cxFramework:interfaceBuilder:component",this.component.init.bind(this.component)),this.control.init(),t(document).on("cxFramework:interfaceBuilder:control",this.control.init.bind(this.control))},component:{tabClass:".cx-tab",accordionClass:".cx-accordion",toggleClass:".cx-toggle",buttonClass:".cx-component__button",contentClass:".cx-settings__content",buttonActiveClass:"active",showClass:"show",localStorage:{},init:function(){this.localStorage=this.getState()||{},this.componentInit(this.tabClass),this.componentInit(this.accordionClass),this.componentInit(this.toggleClass),this.addEvent()},addEvent:function(){t("body").off("click.cxInterfaceBuilder").on("click.cxInterfaceBuilder",this.tabClass+" "+this.buttonClass+", "+this.toggleClass+" "+this.buttonClass+", "+this.accordionClass+" "+this.buttonClass,this.componentClick.bind(this)),t("body").on("cx-switcher-change",function(t){console.log(t)})},componentInit:function(e){var i=this,a=null,s=null,n=null,c="";t(e).each(function(o,l){switch(l=t(l),a=l.data("compotent-id"),e){case i.toggleClass:i.localStorage[a]&&i.localStorage[a].length&&(c=i.localStorage[a].join(", ")),t(i.contentClass,l).not(c).addClass(i.showClass).prevAll(i.buttonClass).addClass(i.buttonActiveClass);break;case i.tabClass:case i.accordionClass:i.localStorage[a]?(n=i.localStorage[a][0],s=t('[data-content-id="'+n+'"]',l)):(s=t(i.buttonClass,l).eq(0),n=s.data("content-id")),i.showElement(s,l,n)}})},componentClick:function(e){var i,a=t(e.target),s=a.closest(this.tabClass+", "+this.accordionClass+", "+this.toggleClass),n=new RegExp(this.tabClass+"|"+this.accordionClass+"|"+this.toggleClass),c=s[0].className.match(n)[0].replace(" ","."),o=a.data("content-id"),l=s.data("compotent-id"),r=a.hasClass(this.buttonActiveClass);switch(c){case this.tabClass:r||(this.hideElement(s),this.showElement(a,s,o),this.localStorage[l]=new Array(o),this.setState());break;case this.accordionClass:this.hideElement(s),r?this.localStorage[l]={}:(this.showElement(a,s,o),this.localStorage[l]=new Array(o)),this.setState();break;case this.toggleClass:a.toggleClass(this.buttonActiveClass).nextAll(o).toggleClass(this.showClass),Array.isArray(this.localStorage[l])?-1!==(i=this.localStorage[l].indexOf(o))?this.localStorage[l].splice(i,1):this.localStorage[l].push(o):this.localStorage[l]=new Array(o),this.setState()}return a.blur(),!1},showElement:function(e,i,a){e.addClass(this.buttonActiveClass),i.data("content-id",a),t(a,i).addClass(this.showClass)},hideElement:function(e){var i=e.data("content-id");t('[data-content-id="'+i+'"]',e).removeClass(this.buttonActiveClass),t(i,e).removeClass(this.showClass)},getState:function(){try{return JSON.parse(localStorage.getItem("interface-builder"))}catch(t){return!1}},setState:function(){try{localStorage.setItem("interface-builder",JSON.stringify(this.localStorage))}catch(t){return!1}}},control:{init:function(){this.switcher.init(),this.checkbox.init(),this.radio.init(),this.slider.init(),this.select.init(),this.media.init(),this.colorpicker.init()},switcher:{switcherClass:".cx-switcher-wrap",trueClass:".cx-input-switcher-true",falseClass:".cx-input-switcher-false",init:function(){t("body").on("click.cxSwitcher",this.switcherClass,this.switchState.bind(this))},switchState:function(e){var i=t(e.currentTarget),a=t(this.trueClass,i),s=t(this.falseClass,i),n=a[0].checked;a.attr("checked",!n),s.attr("checked",!!n),t("body").trigger({type:"cx-switcher-change",switcherStatus:n})}},checkbox:{inputClass:'.cx-checkbox-input[type="hidden"]:not([name*="__i__"])',itemClass:".cx-checkbox-label, .cx-checkbox-item",init:function(){t("body").on("click.cxCheckbox",this.itemClass,this.switchState.bind(this))},switchState:function(e){var i=t(e.currentTarget).siblings(this.inputClass),a=i[0].checked;i.val(a?"false":"true").attr("checked",!a)}},radio:{inputClass:'.cx-radio-input:not([name*="__i__"])',init:function(){t("body").on("click.cxRadio",this.inputClass,this.switchState.bind(this))},switchState:function(e){t(e.currentTarget)}},slider:{init:function(){t("body").on("input.cxSlider change.cxSlider",".cx-slider-unit, .cx-ui-stepper-input",this.changeHandler.bind(this))},changeHandler:function(e){var i=t(e.currentTarget),a=i.closest(".cx-slider-wrap"),s=i.hasClass("cx-slider-unit")?".cx-ui-stepper-input":".cx-slider-unit";t(s,a).val(i.val())}},select:{selectClass:'.cx-ui-select[data-filter="true"]:not([name*="__i__"]), .cx-ui-select[multiple]:not([name*="__i__"])',init:function(){t(document).on("ready.cxSelect",this.selectRender.bind(this)).on("cx-control-init",this.selectRender.bind(this))},selectRender:function(){var e=event._target?event._target:t("body");t(this.selectClass,e).each(this.select2Init.bind(this))},select2Init:function(e,i){var a=t(i);a.select2({placeholder:a.data("placeholder")})}},media:{init:function(){t(document).on("ready.cxMedia",this.mediaRender.bind(this)).on("cx-control-init",this.mediaRender.bind(this))},mediaRender:function(){var e=event._target?event._target:t("body");t(".cx-upload-button",e).each(function(){var e=t(this),i=e.closest(".cx-ui-media-wrap"),a={input:t(".cx-upload-input",i),img_holder:t(".cx-upload-preview",i),title_text:e.data("title"),multiple:e.data("multi-upload"),library_type:e.data("library-type")},s=wp.media.frames.file_frame=wp.media({title:a.title_text,button:{text:a.title_text},multiple:a.multiple,library:{type:a.library_type}});if(!i.has('input[name*="__i__"]')[0]){e.off("click.cx-media").on("click.cx-media",function(){return s.open(),!1}),s.on("select",function(){var e=s.state().get("selection").toJSON(),i=0,n="",c=t(".cx-all-images-wrap",a.img_holder),o="",l="";for(a.multiple&&(n=a.input.val(),l=",",o=c.html());e[i];){var r=e[i],h=r.id,d="",u="";switch(r.mime){case"image/jpeg":case"image/png":case"image/gif":void 0!==r.sizes&&(d=r.sizes.thumbnail?r.sizes.thumbnail.url:r.sizes.full.url),u='<img  src="'+d+'" alt="" data-img-attr="'+h+'">';break;case"image/x-icon":u='<span class="dashicons dashicons-format-image"></span>';break;case"video/mpeg":case"video/mp4":case"video/quicktime":case"video/webm":case"video/ogg":u='<span class="dashicons dashicons-format-video"></span>';break;case"audio/mpeg":case"audio/wav":case"audio/ogg":u='<span class="dashicons dashicons-format-audio"></span>'}o+='<div class="cx-image-wrap"><div class="inner"><div class="preview-holder"  data-id-attr="'+h+'"><div class="centered">'+u+'</div></div><a class="cx-remove-image" href="#"><i class="dashicons dashicons-no"></i></a><span class="title">'+r.title+"</span></div></div>",n+=l+h,i++}a.input.val(n.replace(/(^,)/,"")).trigger("change"),c.html(o)});i.on("click",".cx-remove-image",function(){var e,i,a,s,n,c,o;return e=t(this),i=e.closest(".cx-ui-media-wrap"),a=t(".cx-upload-input",i),s=e.parent().parent(".cx-image-wrap"),n=t(".preview-holder",s).data("id-attr"),c=a.attr("value"),o=new RegExp(n+"(,*)","i"),c=(c=c.replace(o,"")).replace(/(,$)/,""),a.attr({value:c}).trigger("change"),s.remove(),!1})}}),t(".cx-all-images-wrap",e).sortable({items:"div.cx-image-wrap",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"cx-media-thumb-sortable-placeholder",start:function(){},stop:function(){},update:function(){var e="";t(".cx-image-wrap",this).each(function(){var i=t(".preview-holder",this).data("id-attr");e=e+i+","}),e=e.substr(0,e.lastIndexOf(",")),t(this).parent().siblings(".cx-element-wrap").find("input.cx-upload-input").val(e).trigger("change")}})}},colorpicker:{init:function(){t(document).on("ready.cxColorpicker",this.render.bind(this)).on("cx-control-init",this.render.bind(this))},render:function(e){var i=e._target?e._target:t("body"),a=t('input.cx-ui-colorpicker:not([name*="__i__"])',i);a[0]&&a.wpColorPicker()}},iconpicker:{init:function(){t(document).on("ready.cxIconpicker",this.render.bind(this)).on("cx-control-init",this.render.bind(this))},render:function(e){e._target?e._target:t("body")}}}}).init()}(jQuery);